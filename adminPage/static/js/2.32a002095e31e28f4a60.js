webpackJsonp([2],{"1HqQ":function(t,e){},"3cq2":function(t,e){},"To/2":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"users",data:function(){return{tableData:[],content:"",multiSelection:[],userId:[],FormVisible:!1,formData:{userName:"",idCard:"",phone:"",pwd:"",avatar:""},formLabelWidth:"120px",token:"",pageSize:5,page:1,total:10}},methods:{findUsers:function(t,e,a){var o=this;this.$axios.get("getUsers",{id:t}).then(function(t){console.log(t.data),o.tableData=t.data})},getToken:function(){var t=this;this.$axios.qiniuGet().then(function(e){t.token=e.data})},upload:function(t){this.formData.avatar=t.url},addUsers:function(){var t=this;this.$axios.post("addUsers",this.formData).then(function(e){200==e.code?(t.$message({type:"success",message:"添加成功"}),setTimeout(function(){t.$router.go(0)},100)):t.$message({type:"error",message:"添加失败"})})},getUsers:function(){var t=this;this.$axios.get("getUsers").then(function(e){t.tableData=e.data})},edit:function(t){this.$router.push({path:"/users/update",query:{id:t}})},del:function(t){var e=this;this.$confirm("此操作将永久删除该内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.post("delUserOne",{id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"删除成功!"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"warning",message:"已取消删除"})})},selectionChange:function(t){this.multiSelection=t},toggleSelection:function(t){var e=this;if(t){for(var a in t)this.userId.push(t[a]._id);this.$axios.post("updateManyPwd",{userId:this.userId}).then(function(t){200==t.code&&e.$message({type:"success",message:"批量修改成功"})})}else this.$message({type:"warning",message:"没有选择"})},open:function(t){var e=this;this.$axios.post("isCanLogin",{isCanLogin:!0,id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"权限已开启"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"danger",message:"开启失败"})})},close:function(t){var e=this;this.$axios.post("isCanLogin",{isCanLogin:!1,id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"权限已禁用"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"danger",message:"禁用失败"})})},formatter:function(t){return t+(this.page-1)*this.pageSize+1},pageChange:function(t){var e=this;this.page=t,this.$axios.get("getUsers",{page:t,pageSize:this.pageSize}).then(function(t){e.tableData=t.data})},getNumber:function(){var t=this;this.$axios.get("getUsersNum").then(function(e){t.total=e.data})}},created:function(){this.getUsers(),this.getToken(),this.getNumber()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"users"},[a("el-header",[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.findUsers(t.content)}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.FormVisible=!0}}},[t._v("导入用户")]),t._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:t.FormVisible},on:{"update:visible":function(e){t.FormVisible=e}}},[a("el-form",{attrs:{model:t.formData}},[a("el-form-item",{attrs:{label:"用户名","label-width":t.formLabelWidth,"filter-method":t.findUsers}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.userName,callback:function(e){t.$set(t.formData,"userName",e)},expression:"formData.userName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"证件号","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.idCard,callback:function(e){t.$set(t.formData,"idCard",e)},expression:"formData.idCard"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"手机号","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.phone,callback:function(e){t.$set(t.formData,"phone",e)},expression:"formData.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.pwd,callback:function(e){t.$set(t.formData,"pwd",e)},expression:"formData.pwd"}})],1),t._v(" "),a("div",{staticClass:"upload"},[a("span",[t._v("图片")]),t._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://upload-z1.qiniup.com","show-file-list":!1,"on-success":t.upload,data:{token:t.token}}},[t.formData.avatar?a("img",{staticClass:"avatar",attrs:{src:t.formData.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.FormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addUsers}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),t._v(" "),a("span",[t._v("设置")]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[t._v("查看")]),t._v(" "),a("el-dropdown-item",[t._v("新增")]),t._v(" "),a("el-dropdown-item",[t._v("删除")])],1)],1)],1),t._v(" "),a("el-main",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{prop:"select",label:"",width:"50","show-overflow-tooltip":"",type:"selection"}}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"#",type:"index",index:t.formatter,width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户名",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"idCard",label:"证件号",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"score",label:"积分",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.edit(e.row._id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.del(e.row._id)}}},[t._v("删除")]),t._v(" "),0==e.row.isCanLogin?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){t.open(e.row._id)}}},[t._v("启用")]):t._e(),t._v(" "),1==e.row.isCanLogin?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.close(e.row._id)}}},[t._v("禁用")]):t._e()]}}])})],1)],1),t._v(" "),a("el-footer",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.toggleSelection(t.multiSelection)}}},[t._v("批量重置密码")]),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next,jumper",total:t.total,"current-page":t.page,"page-size":t.pageSize},on:{"current-change":t.pageChange}})],1)],1)},staticRenderFns:[]};var i=a("VU/8")(o,s,!1,function(t){a("3cq2"),a("1HqQ")},null,null);e.default=i.exports}});
//# sourceMappingURL=2.32a002095e31e28f4a60.js.map