webpackJsonp([6],{Vdiq:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("Dd8w"),s=o.n(i),a={name:"",components:{editor:o("mBlC").a},data:function(){return{multiSelection:[],reviewId:[],tableData:[],formData:{title:"",desc:"",status:""},FormVisible:!1,editorInit:!1,pageSize:5,page:1,total:10}},methods:{getReview:function(){var t=this;this.$axios.get("getReview").then(function(e){t.tableData=e.data})},edit:function(t){var e=this;this.$router.push({path:"/review",query:{id:t}}),this.$axios.get("getReview",{id:this.$route.query.id}).then(function(t){e.formData=t.data})},updateReview:function(){var t=this;this.$nextTick(function(){t.editorInit=!0});var e=s()({},this.formData,{id:this.$route.query.id});this.$axios.post("updateReview",e).then(function(e){200==e.code?(t.$message({message:""+e.msg,type:"success"}),t.FormVisible=!1,setTimeout(function(){t.$router.push("/review"),t.$router.go(0)},1e3)):t.$message({message:""+e.msg,type:"warning"})})},cancel:function(){var t=this;this.FormVisible=!1,setTimeout(function(){t.$router.push("/review")},1e3)},del:function(t){var e=this;console.log(t),this.$confirm("此操作将永久删除该内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.post("delReview",{id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"删除成功!"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"warning",message:"已取消删除"})})},open:function(t){var e=this;this.$axios.post("updateStatus",{status:1,id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"开启成功!"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"error",message:"已经有一个已经开启的民主评议了!"})})},close:function(t){var e=this;this.$axios.post("updateStatus",{status:2,id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"关闭成功!"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"error",message:"关闭失败!"})})},selectionChange:function(t){this.multiSelection=t},toggleSelection:function(t){var e=this;if(t){for(var o in t)this.reviewId.push(t[o]._id);this.$axios.post("delManyReview",{id:this.reviewId}).then(function(t){200==t.code&&(e.$message({type:"success",message:"批量删除成功"}),setTimeout(function(){e.$router.go(0)},1e3))})}else this.$message({type:"warning",message:"没有选择"})},formatter:function(t){return t+(this.page-1)*this.pageSize+1},pageChange:function(t){var e=this;this.page=t,this.$axios.get("getReview",{page:t,pageSize:this.pageSize}).then(function(t){e.tableData=t.data})},getNumber:function(){var t=this;this.$axios.get("getReviewNum").then(function(e){t.total=e.data})},toDetails:function(t){this.$router.push({path:"/review/perSummary",query:{id:t}})}},created:function(){this.getReview(),this.getNumber()}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"list"},[o("el-main",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.selectionChange}},[o("el-table-column",{attrs:{prop:"select",label:"",width:"50","show-overflow-tooltip":"",type:"selection"}}),t._v(" "),o("el-table-column",{attrs:{prop:"",label:"#",width:"100",type:"index",index:t.formatter,"show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"title",label:"描述",width:"200",color:"red","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{staticStyle:{color:"#409EFF","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(o){t.toDetails(e.row._id)}}},[t._v(t._s(e.row.title))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"status",label:"状态",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?o("el-tag",{attrs:{type:"success"}},[t._v("进行中")]):t._e(),t._v(" "),2==e.row.status?o("el-tag",{attrs:{type:"danger"}},[t._v("已结束")]):t._e(),t._v(" "),0==e.row.status?o("el-tag",{attrs:{type:"info"}},[t._v("未进行")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"createTime",label:"时间",width:"200","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(o){t.FormVisible=!0,t.edit(e.row._id)}}},[t._v("编辑")]),t._v(" "),o("el-dialog",{attrs:{title:"编辑",visible:t.FormVisible},on:{"update:visible":function(e){t.FormVisible=e}}},[o("el-form",{attrs:{model:t.formData}},[o("el-form-item",{attrs:{label:"描述"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"状态"}},[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}})],1),t._v(" "),o("el-form-item",{attrs:{label:""}},[o("div",[t._v("内容")]),t._v(" "),o("editor",{model:{value:t.formData.desc,callback:function(e){t.$set(t.formData,"desc",e)},expression:"formData.desc"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.updateReview}},[t._v("确 定")])],1)],1),t._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){t.del(e.row._id)}}},[t._v("删除")]),t._v(" "),2==e.row.status||0==e.row.status?o("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(o){t.open(e.row._id)}}},[t._v("开启")]):t._e(),t._v(" "),1==e.row.status?o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){t.close(e.row._id)}}},[t._v("结束")]):t._e()]}}])})],1)],1),t._v(" "),o("el-footer",[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.toggleSelection(t.multiSelection)}}},[t._v("批量删除")]),t._v(" "),o("el-pagination",{attrs:{background:"",layout:"prev, pager, next,jumper",total:t.total,"current-page":t.page,"page-size":t.pageSize},on:{"current-change":t.pageChange}})],1)],1)},staticRenderFns:[]};var r=o("VU/8")(a,n,!1,function(t){o("W4kz")},null,null);e.default=r.exports},W4kz:function(t,e){}});
//# sourceMappingURL=6.1c0be2d27136f055b054.js.map