webpackJsonp([11],{LbJp:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"news",data:function(){return{newsType:"",options:[],tableData:[],FormVisible:!1,formData:{label:"",value:""},formLabelWidth:"120px",formDataFirst:{title:"",img:"",url:"",sort:"",isShow:""},FormVisibleFirst:!1,token:"",multiSelection:[],userId:[],type:void 0,pageSize:5,page:1,total:5}},methods:{getType:function(){var t=this;this.$axios.get("getNewsCate").then(function(e){t.options=e.data})},findTypeNews:function(t){var e=this;this.type=t,this.$axios.get("getNews",{type:t}).then(function(t){e.tableData=t.data})},addNewsType:function(){var t=this;this.$axios.post("addNewsCate",this.formData).then(function(e){200==e.code?t.$message({type:"success",message:"添加成功"}):t.$message({type:"error",message:"删除失败"}),setTimeout(function(){t.$router.go(0)},100)})},getNews:function(){var t=this;this.$axios.get("getNews").then(function(e){t.tableData=e.data})},getToken:function(){var t=this;this.$axios.qiniuGet().then(function(e){t.token=e.data})},upload:function(t){this.formData.img=t.url},changeImg:function(t){var e=this;this.$axios.get("getNews",{id:t}).then(function(t){e.formDataFirst=t.data})},addCarousel:function(){var t=this;this.$axios.post("addCarousels",this.formDataFirst).then(function(e){200==e.code?t.$message({type:"success",message:"添加成功"}):t.$message({type:"error",message:"删除失败"}),setTimeout(function(){t.$router.go(0)},100)})},edit:function(t){this.$router.push({path:"/news/update",query:{id:t}})},del:function(t){var e=this;this.$confirm("此操作将永久删除该内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.post("delNews",{id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"删除成功!"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"warning",message:"已取消删除"})})},selectionChange:function(t){this.multiSelection=t},formatter:function(t){return t+(this.page-1)*this.pageSize+1},pageChange:function(t){var e=this;this.getNumber(),this.page=t,this.$axios.get("getNews",{page:t,pageSize:this.pageSize,type:this.type}).then(function(t){e.tableData=t.data})},getNumber:function(){var t=this;this.$axios.get("getNewsNum",{type:this.type}).then(function(e){console.log(t.type),t.total=e.data})}},created:function(){this.getType(),this.getNews(),this.getToken(),this.getNumber()}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("el-header",[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:t.newsType,callback:function(e){t.newsType=e},expression:"newsType"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.findTypeNews(t.newsType)}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.FormVisible=!0}}},[t._v("添加类型")]),t._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:t.FormVisible},on:{"update:visible":function(e){t.FormVisible=e}}},[a("el-form",{attrs:{model:t.formData}},[a("el-form-item",{attrs:{label:"新闻类型","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.label,callback:function(e){t.$set(t.formData,"label",e)},expression:"formData.label"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"类型值","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.value,callback:function(e){t.$set(t.formData,"value",e)},expression:"formData.value"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.FormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addNewsType}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dropdown",[a("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),t._v(" "),a("span",[t._v("设置")]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[t._v("查看")]),t._v(" "),a("el-dropdown-item",[t._v("新增")]),t._v(" "),a("el-dropdown-item",[t._v("删除")])],1)],1)],1),t._v(" "),a("el-main",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{prop:"select",label:"",width:"50","show-overflow-tooltip":"",type:"selection"}}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"#",type:"index",index:t.formatter,width:"50","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"220","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"发布时间",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"新闻类别",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("轮播图")]):t._e(),t._v(" "),2==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("信工新闻眼")]):t._e(),t._v(" "),3==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("政治学习")]):t._e(),t._v(" "),4==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("党建一点通")]):t._e(),t._v(" "),5==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("党员亮身份")]):t._e(),t._v(" "),6==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("随时随地学")]):t._e(),t._v(" "),7==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("随时随地拍")]):t._e(),t._v(" "),8==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("制度建设")]):t._e(),t._v(" "),9==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("特色活动")]):t._e(),t._v(" "),10==e.row.type?a("el-tag",{attrs:{type:"info"}},[t._v("通知早知道")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.edit(e.row._id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.del(e.row._id)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){t.FormVisibleFirst=!0,t.changeImg(e.row._id)}}},[t._v("生成轮播图")]),t._v(" "),a("el-dialog",{attrs:{title:"添加轮播图",visible:t.FormVisibleFirst},on:{"update:visible":function(e){t.FormVisibleFirst=e}}},[a("el-form",{attrs:{model:t.formDataFirst}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formDataFirst.title,callback:function(e){t.$set(t.formDataFirst,"title",e)},expression:"formDataFirst.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"跳转链接"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formDataFirst.url,callback:function(e){t.$set(t.formDataFirst,"url",e)},expression:"formDataFirst.url"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"优先级"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formDataFirst.sort,callback:function(e){t.$set(t.formDataFirst,"sort",e)},expression:"formDataFirst.sort"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.formDataFirst.isShow,callback:function(e){t.$set(t.formDataFirst,"isShow",e)},expression:"formDataFirst.isShow"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"图片"}},[a("div",{staticClass:"upload"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://upload-z1.qiniup.com","show-file-list":!1,"on-success":t.upload,data:{token:t.token}}},[t.formDataFirst.img?a("img",{staticClass:"avatar",attrs:{src:t.formDataFirst.img}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.FormVisibleFirst=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addCarousel}},[t._v("确 定")])],1)],1)]}}])})],1)],1),t._v(" "),a("el-footer",[a("el-button",{attrs:{type:"primary"}},[t._v("批量重置密码")]),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next,jumper",total:t.total,"current-page":t.page,"page-size":t.pageSize},on:{"current-change":t.pageChange}})],1)],1)},staticRenderFns:[]};var s=a("VU/8")(o,i,!1,function(t){a("N4CL")},null,null);e.default=s.exports},N4CL:function(t,e){}});
//# sourceMappingURL=11.2ade866b80a22c1d1307.js.map