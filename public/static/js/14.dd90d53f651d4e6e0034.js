webpackJsonp([14],{E2Rk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"",data:function(){return{tableData:[],multiSelection:[],imgId:[],FormVisible:!1,formData:{img:"",title:"",url:"",sort:"",isShow:!0},formLabelWidth:"120px",token:"",pageSize:5,page:1,total:10}},methods:{getCarousels:function(){var t=this;this.$axios.get("getCarousels").then(function(e){t.tableData=e.data})},getToken:function(){var t=this;this.$axios.qiniuGet().then(function(e){t.token=e.data})},upload:function(t){this.formData.img=t.url},addCarousels:function(){var t=this;this.$axios.post("addCarousels",this.formData).then(function(e){200==e.code?(t.$message({type:"success",message:"添加成功"}),setTimeout(function(){t.$router.go(0)},100)):t.$message({type:"error",message:"添加失败"})})},changeIsShow:function(){1==this.formData.isShow?this.formData.isShow=!1:this.formData.isShow=!0},edit:function(t){this.$router.push({path:"/carousel/update",query:{id:t}})},del:function(t){var e=this;this.$confirm("此操作将永久删除该内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.post("delCarousels",{id:t}).then(function(t){200==t.code?(e.$message({type:"success",message:"删除成功!"}),setTimeout(function(){e.$router.go(0)},1e3)):e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"warning",message:"已取消删除"})})},selectionChange:function(t){this.multiSelection=t},toggleSelection:function(t){var e=this;if(t){for(var a in t)this.imgId.push(t[a]._id);this.$axios.post("delManyCarousels",{id:this.imgId}).then(function(t){200==t.code&&(e.$message({type:"success",message:"批量删除成功"}),setTimeout(function(){e.$router.go(0)},1e3))})}else this.$message({type:"warning",message:"没有选择"})},formatter:function(t){return t+(this.page-1)*this.pageSize+1},pageChange:function(t){var e=this;this.page=t,this.$axios.get("getCarousels",{page:t,pageSize:this.pageSize}).then(function(t){e.tableData=t.data})},getNumber:function(){var t=this;this.$axios.get("getCarouselsNum").then(function(e){t.total=e.data})}},created:function(){this.getCarousels(),this.getToken(),this.getNumber()}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"carousel"},[a("el-main",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{prop:"select",label:"",width:"50","show-overflow-tooltip":"",type:"selection"}}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"#",width:"100",type:"index",index:t.formatter,"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"img",label:"缩略图","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticClass:"imgItem",attrs:{src:t.row.img,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"顺序",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"isShow",label:"状态",width:"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.isShow?a("el-tag",{attrs:{type:"success"}},[t._v("启用")]):t._e(),t._v(" "),0==e.row.isShow?a("el-tag",{attrs:{type:"danger"}},[t._v("禁用")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"200","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.edit(e.row._id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.del(e.row._id)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-footer",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.FormVisible=!0}}},[t._v("添加")]),t._v(" "),a("el-dialog",{attrs:{title:"添加",visible:t.FormVisible},on:{"update:visible":function(e){t.FormVisible=e}}},[a("el-form",{attrs:{model:t.formData}},[a("el-form-item",{attrs:{label:"标题","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"跳转链接","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.url,callback:function(e){t.$set(t.formData,"url",e)},expression:"formData.url"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"顺序","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.formData.sort,callback:function(e){t.$set(t.formData,"sort",e)},expression:"formData.sort"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":t.formLabelWidth}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949",change:t.changeIsShow},model:{value:t.formData.isShow,callback:function(e){t.$set(t.formData,"isShow",e)},expression:"formData.isShow"}})],1),t._v(" "),a("el-form-item",{staticClass:"avatar-uploader",attrs:{label:"缩略图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://upload-z1.qiniup.com","show-file-list":!1,"on-success":t.upload,data:{token:t.token}}},[t.formData.img?a("img",{staticClass:"avatar",attrs:{src:t.formData.img}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.FormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addCarousels}},[t._v("确 定")])],1)],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.toggleSelection(t.multiSelection)}}},[t._v("批量删除")]),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next,jumper",total:t.total,"current-page":t.page,"page-size":t.pageSize},on:{"current-change":t.pageChange}})],1)],1)},staticRenderFns:[]};var s=a("VU/8")(o,i,!1,function(t){a("qljL")},null,null);e.default=s.exports},qljL:function(t,e){}});
//# sourceMappingURL=14.dd90d53f651d4e6e0034.js.map